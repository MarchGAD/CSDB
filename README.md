# DBENet

A DTPLDA-Like Neural Back-End Network for X-vector Based Speaker Verification.

# Requirements

* python3

* torch

* kaldiio

* kaldi

# Others

A LDA matrix in '/kaldi_mats' is generated by 'ivector-compute-lda' without zero-centering, e.g.

`ivector-compute-lda --total-covariance-factor=0.0 --dim=100 "ark:ivector-subtract-global-mean zero.vec scp:scps/train.scp ark:- |" ark:kaldi-master/egs/voxceleb/v2/data/train/utt2spk kaldi_mats/not_sub_100_transform.mat`

**Note** that the 'zero.vec' is a zero vector generated by Numpy and kaldiio, and 'scores/trials' is generated by script in kaldi on 'kaldi-master/egs/voxceleb/v2/run.sh'.

# Run light demo

A light demo with needed data has been prepared, please run the demo to check the environment is fully setted.

**Note** that all the following commands are started under './DTPLDA-like-neural-backend/.'

#### step 1: use absolute path in '.json' and '.scp'
```
python utils/scp_relative2abs.py scps/demo
python utils/json_relative2abs.py json_configs/demo.json
```
#### step 2: run demo
```
python train.py json_configs/demo.py &
```
#### step 3: see the log
Log is in 'exp/demo/log'
```
tail -f exp/demo/log
```
#### step 4: test
```
cd exp/demo/score
python get_scores.py -e 1
// wait for scoring
cat result
```

# Trained model
A trained model using tdnn extractor has been placed in 'exp/kaldi_lda_100/nnet/kaldi_lda_100_epoch_50'. The compared baseline is from [kaldi x-vector](http://kaldi-asr.org/models/m7).

**Note** that all the following commands are started under './DTPLDA-like-neural-backend/.'

#### see validate result

```
cat exp/kaldi_lda_100/validate_eer_mindcf
```

#### get score

```
cd exp/kaldi_lda_100/score
python get_scores -e 50
//wait for scoring
cat result
```

# Results

Models of results we showed in paper didn't trained really well at that time, so the following results may be better.

| Name | Extractor | Network | GPLDA EER(\%) | **DBENet** EER(\%)|
| ------ | ------ | ------ | ------ | ------ |
| FC A | TDNN | kaldi_lda | 3.1177 | **2.5822** |
| CNN  | TDNN | kaldi_cnn | 3.1177 | **2.7678** |
| FC B | ResNet | kaldi_lda | 2.3171 | **1.9459** |
| FC C | EFTDNN | kaldi_lda | 1.0392 | **0.9067** |