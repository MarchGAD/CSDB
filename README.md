# DBENet

A DTPLDA-Like Neural Back-End Network for X-vector Based Speaker Verification.

# Requirements

python3

torch

kaldiio

kaldi

A LDA matrix generated by 'ivector-compute-lda' without zero-centering.

# Run light demo

A light demo with needed data has been prepared, please run the demo to check the environment is fully setted.

**Note** that all the following commands are started under './DTPLDA-like-neural-backend/.'

#### step 1: use absolute path in '.json' and '.scp'
```
python utils/scp_relative2abs.py scps/demo
python utils/json_relative2abs.py json_configs/demo.json
```
#### step 2: run demo
```
python train.py json_configs/demo.py &
```
#### step 3: see the log
Log is in 'exp/demo/log'
```
tail -f exp/demo/log
```
#### step 4: test
```
cd exp/demo/score
python get_scores.py -e 1
// wait for scoring
cat result
```

# Trained model
A trained model using tdnn extractor has been placed in 'exp/kaldi_lda_100/nnet/kaldi_lda_100_epoch_50'. The compared baseline is from [kaldi x-vector](http://kaldi-asr.org/models/m7').

**Note** that all the following commands are started under './DTPLDA-like-neural-backend/.'

#### see validate result

```
cat exp/kaldi_lda_100/validate_eer_mindcf
```

#### get score

```
cd exp/kaldi_lda_100/score
python get_scores -e 50
//wait for scoring
cat result
```